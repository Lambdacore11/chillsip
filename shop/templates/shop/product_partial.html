{% load static %}

{% for product in page_obj %}
    <div class="item">
        <a class="item__link" href="{{ product.get_absolute_url }}">
            <img class="item__image" src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'images/product_no_image.jpg' %}{% endif %}">
        </a>
        <a class="link" href="{{ product.get_absolute_url }}">{{ product.name }}</a>
        <div class="text">{{ product.price }}₽</div>
        <img class="item__rating" src="{% static product.get_average_rating_url %}">
        {% if product.count > 0 %}
            <div class="text text_italic">осталось {{ product.count }}</div>
        {% else %}
            <div class="text text_italic">раскупили</div>
        {% endif %}
    </div>
{% endfor %}

{% if page_obj.has_next %}
    <div
        hx-get="?{% if category %}category={{ category.slug }}&{% endif %}page={{ page_obj.next_page_number }}"
        hx-trigger="revealed"
        hx-swap="outerHTML"
        class="loadMore"
        >
        <div class="spinner"></div>
    </div>

{% endif %}